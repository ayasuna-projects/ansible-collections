[Unit]
Description=The K3s service
DefaultDependencies=yes
Wants=network.target var-lib-kubelet.mount var-lib-rancher.mount etc-rancher.mount
After=network.target var-lib-kubelet.mount var-lib-rancher.mount etc-rancher.mount

[Service]
Type=notify
KillMode=process
Delegate=yes
User=root
LimitNOFILE=1048576
LimitNPROC=infinity
LimitCORE=infinity
TasksMax=infinity
TimeoutStartSec=0
Restart=always
RestartSec=5s
ExecStartPre=-/sbin/modprobe br_netfilter
ExecStartPre=-/sbin/modprobe overlay
ExecStart=/usr/local/bin/k3s {{ ayasuna__ingot__k8s__privates__arguments.prepared.k3s_node_service_cli_arguments }}